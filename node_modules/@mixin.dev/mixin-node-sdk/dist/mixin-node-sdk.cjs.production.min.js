"use strict";function e(e){return e&&"object"==typeof e&&"default"in e?e.default:e}Object.defineProperty(exports,"__esModule",{value:!0});var t=e(require("nano-seconds")),r=e(require("node-forge")),n=require("int64-buffer"),i=require("uuid"),o=e(require("bignumber.js")),s=require("@noble/curves/ed25519"),a=require("@noble/curves/abstract/modular"),u=require("@noble/curves/abstract/utils"),f=require("@noble/hashes/blake3"),c=require("@noble/hashes/sha3"),p=require("@noble/hashes/sha256"),d=require("@noble/hashes/sha512"),h=e(require("axios")),l=require("axios-retry"),m=e(l),g=e(require("is-retry-allowed")),v=e(require("serialize-javascript")),w=e(require("ws")),b=e(require("bs58")),y=e(require("qs")),x=require("pako"),B=e(require("lodash.merge"));function k(){k=function(){return e};var e={},t=Object.prototype,r=t.hasOwnProperty,n="function"==typeof Symbol?Symbol:{},i=n.iterator||"@@iterator",o=n.asyncIterator||"@@asyncIterator",s=n.toStringTag||"@@toStringTag";function a(e,t,r){return Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{a({},"")}catch(e){a=function(e,t,r){return e[t]=r}}function u(e,t,r,n){var i=Object.create((t&&t.prototype instanceof p?t:p).prototype),o=new E(n||[]);return i._invoke=function(e,t,r){var n="suspendedStart";return function(i,o){if("executing"===n)throw new Error("Generator is already running");if("completed"===n){if("throw"===i)throw o;return{value:void 0,done:!0}}for(r.method=i,r.arg=o;;){var s=r.delegate;if(s){var a=y(s,r);if(a){if(a===c)continue;return a}}if("next"===r.method)r.sent=r._sent=r.arg;else if("throw"===r.method){if("suspendedStart"===n)throw n="completed",r.arg;r.dispatchException(r.arg)}else"return"===r.method&&r.abrupt("return",r.arg);n="executing";var u=f(e,t,r);if("normal"===u.type){if(n=r.done?"completed":"suspendedYield",u.arg===c)continue;return{value:u.arg,done:r.done}}"throw"===u.type&&(n="completed",r.method="throw",r.arg=u.arg)}}}(e,r,o),i}function f(e,t,r){try{return{type:"normal",arg:e.call(t,r)}}catch(e){return{type:"throw",arg:e}}}e.wrap=u;var c={};function p(){}function d(){}function h(){}var l={};a(l,i,(function(){return this}));var m=Object.getPrototypeOf,g=m&&m(m(S([])));g&&g!==t&&r.call(g,i)&&(l=g);var v=h.prototype=p.prototype=Object.create(l);function w(e){["next","throw","return"].forEach((function(t){a(e,t,(function(e){return this._invoke(t,e)}))}))}function b(e,t){var n;this._invoke=function(i,o){function s(){return new t((function(n,s){!function n(i,o,s,a){var u=f(e[i],e,o);if("throw"!==u.type){var c=u.arg,p=c.value;return p&&"object"==typeof p&&r.call(p,"__await")?t.resolve(p.__await).then((function(e){n("next",e,s,a)}),(function(e){n("throw",e,s,a)})):t.resolve(p).then((function(e){c.value=e,s(c)}),(function(e){return n("throw",e,s,a)}))}a(u.arg)}(i,o,n,s)}))}return n=n?n.then(s,s):s()}}function y(e,t){var r=e.iterator[t.method];if(void 0===r){if(t.delegate=null,"throw"===t.method){if(e.iterator.return&&(t.method="return",t.arg=void 0,y(e,t),"throw"===t.method))return c;t.method="throw",t.arg=new TypeError("The iterator does not provide a 'throw' method")}return c}var n=f(r,e.iterator,t.arg);if("throw"===n.type)return t.method="throw",t.arg=n.arg,t.delegate=null,c;var i=n.arg;return i?i.done?(t[e.resultName]=i.value,t.next=e.nextLoc,"return"!==t.method&&(t.method="next",t.arg=void 0),t.delegate=null,c):i:(t.method="throw",t.arg=new TypeError("iterator result is not an object"),t.delegate=null,c)}function x(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function B(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function E(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(x,this),this.reset(!0)}function S(e){if(e){var t=e[i];if(t)return t.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var n=-1,o=function t(){for(;++n<e.length;)if(r.call(e,n))return t.value=e[n],t.done=!1,t;return t.value=void 0,t.done=!0,t};return o.next=o}}return{next:I}}function I(){return{value:void 0,done:!0}}return d.prototype=h,a(v,"constructor",h),a(h,"constructor",d),d.displayName=a(h,s,"GeneratorFunction"),e.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===d||"GeneratorFunction"===(t.displayName||t.name))},e.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,h):(e.__proto__=h,a(e,s,"GeneratorFunction")),e.prototype=Object.create(v),e},e.awrap=function(e){return{__await:e}},w(b.prototype),a(b.prototype,o,(function(){return this})),e.AsyncIterator=b,e.async=function(t,r,n,i,o){void 0===o&&(o=Promise);var s=new b(u(t,r,n,i),o);return e.isGeneratorFunction(r)?s:s.next().then((function(e){return e.done?e.value:s.next()}))},w(v),a(v,s,"Generator"),a(v,i,(function(){return this})),a(v,"toString",(function(){return"[object Generator]"})),e.keys=function(e){var t=[];for(var r in e)t.push(r);return t.reverse(),function r(){for(;t.length;){var n=t.pop();if(n in e)return r.value=n,r.done=!1,r}return r.done=!0,r}},e.values=S,E.prototype={constructor:E,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(B),!e)for(var t in this)"t"===t.charAt(0)&&r.call(this,t)&&!isNaN(+t.slice(1))&&(this[t]=void 0)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var t=this;function n(r,n){return s.type="throw",s.arg=e,t.next=r,n&&(t.method="next",t.arg=void 0),!!n}for(var i=this.tryEntries.length-1;i>=0;--i){var o=this.tryEntries[i],s=o.completion;if("root"===o.tryLoc)return n("end");if(o.tryLoc<=this.prev){var a=r.call(o,"catchLoc"),u=r.call(o,"finallyLoc");if(a&&u){if(this.prev<o.catchLoc)return n(o.catchLoc,!0);if(this.prev<o.finallyLoc)return n(o.finallyLoc)}else if(a){if(this.prev<o.catchLoc)return n(o.catchLoc,!0)}else{if(!u)throw new Error("try statement without catch or finally");if(this.prev<o.finallyLoc)return n(o.finallyLoc)}}}},abrupt:function(e,t){for(var n=this.tryEntries.length-1;n>=0;--n){var i=this.tryEntries[n];if(i.tryLoc<=this.prev&&r.call(i,"finallyLoc")&&this.prev<i.finallyLoc){var o=i;break}}o&&("break"===e||"continue"===e)&&o.tryLoc<=t&&t<=o.finallyLoc&&(o=null);var s=o?o.completion:{};return s.type=e,s.arg=t,o?(this.method="next",this.next=o.finallyLoc,c):this.complete(s)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),c},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.finallyLoc===e)return this.complete(r.completion,r.afterLoc),B(r),c}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.tryLoc===e){var n=r.completion;if("throw"===n.type){var i=n.arg;B(r)}return i}}throw new Error("illegal catch attempt")},delegateYield:function(e,t,r){return this.delegate={iterator:S(e),resultName:t,nextLoc:r},"next"===this.method&&(this.arg=void 0),c}},e}function E(e,t,r,n,i,o,s){try{var a=e[o](s),u=a.value}catch(e){return void r(e)}a.done?t(u):Promise.resolve(u).then(n,i)}function S(e){return function(){var t=this,r=arguments;return new Promise((function(n,i){var o=e.apply(t,r);function s(e){E(o,n,i,s,a,"next",e)}function a(e){E(o,n,i,s,a,"throw",e)}s(void 0)}))}}function I(){return(I=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e}).apply(this,arguments)}function A(e){return(A=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function _(e,t){return(_=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}function C(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}function T(e,t,r){return(T=C()?Reflect.construct.bind():function(e,t,r){var n=[null];n.push.apply(n,t);var i=new(Function.bind.apply(e,n));return r&&_(i,r.prototype),i}).apply(null,arguments)}function L(e){var t="function"==typeof Map?new Map:void 0;return(L=function(e){if(null===e||!function(e){return-1!==Function.toString.call(e).indexOf("[native code]")}(e))return e;if("function"!=typeof e)throw new TypeError("Super expression must either be null or a function");if(void 0!==t){if(t.has(e))return t.get(e);t.set(e,r)}function r(){return T(e,arguments,A(this).constructor)}return r.prototype=Object.create(e.prototype,{constructor:{value:r,enumerable:!1,writable:!0,configurable:!0}}),_(r,e)})(e)}for(var O=function(e){var t=e;return("string"==typeof e||e instanceof Uint8Array)&&(t=Buffer.from(e)),0===t.length?"":t.toString("base64").replaceAll("=","").replaceAll("+","-").replaceAll("/","_")},M=function(e){var t=e instanceof Buffer?e.toString():e;return t=t.replaceAll("-","+").replaceAll("_","/"),Buffer.from(t,"base64")},P="0";P.length<256;)P+=P;var N=function(e){return o("1"+P.substring(0,e))},U=function(e,t){var r=N(t);return o(e).dividedBy(r)},R=function(e,t){var r=N(t);return o(e).times(r)},D=Buffer.from([119,119]),q=Buffer.from([0,0]),F=function(e){var t=[],r=e;do{t.unshift(255&r),r=r/Math.pow(2,8)|0}while(0!==r);return t},j=function(e){var t=[],r=e;do{t.unshift(r.mod(256).toNumber()),r=r.dividedToIntegerBy(256)}while(!r.isZero());return Buffer.from(t)},H=function(e){for(var t=[],r=0;e>=128;)t[r]=128|e,e>>=7,r++;return t[r]=e,t},G=function(){function e(e){this.buf=Buffer.from(""),e&&(this.buf=e)}var t=e.prototype;return t.hex=function(){return this.buf.toString("hex")},t.write=function(e){this.buf=Buffer.concat([this.buf,e])},t.writeBytes=function(e){this.writeInt(e.byteLength),this.write(e)},t.writeSlice=function(e){var t=e.length;if(t>128)throw new Error("slice too long, length "+t+", maximum 128");this.write(Buffer.from([t])),this.write(e)},t.writeInt=function(e){if(e>65535)throw new Error("invalid integer "+e+", maximum 65535");var t=Buffer.alloc(2);t.writeUInt16BE(e),this.write(t)},t.writeUint16=function(e){var t=Buffer.alloc(2);t.writeUInt16BE(e),this.write(t)},t.writeUint32=function(e){var t=Buffer.alloc(4);t.writeUInt32BE(e),this.write(t)},t.writeUint64=function(e){var t=Buffer.alloc(8);t.writeBigUInt64BE(e),this.write(t)},t.writeInteger=function(e){var t=j(e);this.writeInt(t.byteLength),this.write(t)},t.writeUUID=function(e){for(var t=i.parse(e),r=0;r<t.length;r+=1)this.write(Buffer.from([t[r]]))},t.encodeInput=function(e){var t=e;this.write(Buffer.from(t.hash,"hex")),this.writeInt(t.index),t.genesis||(t.genesis=""),this.writeInt(t.genesis.length),this.write(Buffer.from(t.genesis));var r=t.deposit;if(void 0===r)this.write(q);else{this.write(D),this.write(Buffer.from(r.chain,"hex"));var n=Buffer.from(r.asset);this.writeInt(n.byteLength),this.write(n);var i=Buffer.from(r.transaction);this.writeInt(i.byteLength),this.write(i),this.writeUint64(r.index),this.writeInteger(R(Number(r.amount).toFixed(8),8))}var o=t.mint;void 0===o?this.write(q):(this.write(D),o.group||(o.group=""),this.writeInt(o.group.length),this.write(Buffer.from(o.group)),this.writeUint64(o.batch),this.writeInteger(R(Number(o.amount).toFixed(8),8)))},t.encodeOutput=function(e){var t=this,r=e;r.type||(r.type=0),this.write(Buffer.from([0,r.type])),this.writeInteger(R(Number(r.amount).toFixed(8),8)),this.writeInt(r.keys.length),r.keys.forEach((function(e){return t.write(Buffer.from(e,"hex"))})),this.write(r.mask?Buffer.from(r.mask,"hex"):Buffer.alloc(32,0)),r.script||(r.script="");var n=Buffer.from(r.script,"hex");this.writeInt(n.byteLength),this.write(n);var i=r.withdrawal;if(i){this.write(D);var o=Buffer.from(i.address);this.writeInt(o.byteLength),this.write(o);var s=Buffer.from(i.tag);this.writeInt(s.byteLength),this.write(s)}else this.write(q)},t.encodeAggregatedSignature=function(e){var t=this;if(this.writeInt(65535),this.writeInt(65281),this.write(Buffer.from(e.signature,"hex")),0===e.signers.length)return this.write(Buffer.from([0])),void this.writeInt(0);e.signers.forEach((function(t,r){if(r>0&&t<=e.signers[r-1])throw new Error("signers not sorted");if(t>65535)throw new Error("signer overflow")}));var r=e.signers[e.signers.length-1];if((1+(r/8|0)|0)>2*e.signature.length)return this.write(Buffer.from([1])),this.writeInt(e.signature.length),void e.signers.forEach((function(e){return t.writeInt(e)}));var n=Buffer.alloc(1+(r/8|0)|0);e.signers.forEach((function(e){n[e/8|0]^=1<<(e%8|0)})),this.write(Buffer.from([0])),this.writeInt(n.length),this.write(n)},t.encodeSignature=function(e){var t=this,r=Object.entries(e).map((function(e){return{index:e[0],sig:e[1]}})).sort((function(e,t){return Number(e.index)-Number(t.index)}));this.writeInt(r.length),r.forEach((function(e){t.writeUint16(Number(e.index)),t.write(Buffer.from(e.sig,"hex"))}))},e}(),z=function(e){var t=e.sort().join("");return V(Buffer.from(t)).toString("hex")},K=function(e,t){var n=[e,t].sort(),o=n[0],s=n[1],a=r.md.md5.create();a.update(o),a.update(s);var u=Buffer.from(a.digest().bytes(),"binary");return u[6]=15&u[6]|48,u[8]=63&u[8]|128,i.stringify(u)},V=function(e){return Buffer.from(c.sha3_256.create().update(e).digest())},X=function(e){return Buffer.from(p.sha256.create().update(e).digest())},W=function(e){return Buffer.from(d.sha512.create().update(e).digest())},J=function(e){return Buffer.from(f.blake3.create({}).update(e).digest())},Y=Buffer.from("ecd3f55c1a631258d69cf7a2def9de1400000000000000000000000000000010","hex"),Q=s.ed25519.ExtendedPoint.fromHex("5866666666666666666666666666666666666666666666666666666666666666"),Z=a.Field(s.ed25519.CURVE.n,void 0,!0),$=function(e){for(var t=e.byteLength-1;t>=0;t--){if(e.at(t)>Y.at(t))return!1;if(e.at(t)<Y.at(t))return!0}return!0},ee=function(e){if(64!==e.byteLength)throw new Error("edwards25519: invalid setUniformBytes input length");var t=Buffer.alloc(64);return e.copy(t),Z.create(u.bytesToNumberLE(t))},te=function(e){if(32!==e.byteLength)throw new Error("invalid scalar length");if(!$(e))throw new Error("invalid scalar encoding");return Z.create(u.bytesToNumberLE(e))},re=function(e){var t=Q.multiply(e);return Buffer.from(t.toRawBytes())},ne=function(e){var t=te(e);return re(t)},ie=function(e){return s.ed25519.ExtendedPoint.fromHex(e.toString("hex"))},oe={scalar:Z,x25519:s.x25519,edwardsToMontgomery:s.edwardsToMontgomery,edwardsToMontgomeryPriv:s.edwardsToMontgomeryPriv,setBytesWithClamping:function(e){if(32!==e.byteLength)throw new Error("edwards25519: invalid SetBytesWithClamping input length");var t=Buffer.alloc(64);return e.copy(t,0,0,32),t[0]&=248,t[31]&=63,t[31]|=64,Z.create(u.bytesToNumberLE(t.subarray(0,32)))},setCanonicalBytes:te,setUniformBytes:ee,isReduced:$,publicFromPrivate:ne,scalarBaseMult:re,scalarBaseMultToPoint:function(e){return Q.multiply(e)},sign:function(e,t){var r=W(t.subarray(0,32)),n=W(Buffer.concat([r.subarray(32),e])),i=ee(n),o=re(i),s=ne(t),a=W(Buffer.concat([o,s,e])),f=ee(a),c=te(t),p=u.numberToBytesLE(Z.add(Z.mul(f,c),i),32);return Buffer.concat([o,p])},newPoint:ie,keyMultPubPriv:function(e,t){var r=ie(e),n=te(t),i=r.multiply(n);return Buffer.from(i.toRawBytes())},hashScalar:function(e,t){var r=Buffer.from(H(t)),n=Buffer.alloc(64),i=J(Buffer.concat([e,r]));i.copy(n,0,0,32),(i=J(i)).copy(n,32,0,32);var o=ee(n);return(i=J(Buffer.from(u.numberToBytesLE(o,32)))).copy(n,0,0,32),(i=J(i)).copy(n,32,0,32),ee(n)}},se=function(){var e=t.now();return 1e9*e[0]+e[1]},ae=function(e){var t="server_public_key"in e?oe.edwardsToMontgomery(Buffer.from(e.server_public_key,"hex")):M(e.pin_token_base64),r=oe.edwardsToMontgomeryPriv(Buffer.from(e.session_private_key,"hex"));return oe.x25519.getSharedSecret(r,t)},ue=function(e,t){var r=new G(e);return r.writeUint64(BigInt(t)),r.buf},fe=function(e,t){if(!t||!t.session_private_key)return"";if(!("server_public_key"in t)&&!("pin_token_base64"in t))return"";for(var i=Buffer.from(e,"hex"),o=Buffer.from(new n.Uint64LE(se()).toBuffer()),s=Buffer.from(new n.Uint64LE(Date.now()/1e3).toBuffer()),a=Buffer.concat([i,s,o]),u=r.util.createBuffer(a.toString("binary")),f=16-u.length()%16,c=[],p=0;p<f;p+=1)c.push(f);u.putBytes(Buffer.from(c).toString("binary"));var d=r.random.getBytesSync(16),h=ae(t),l=r.cipher.createCipher("AES-CBC",r.util.createBuffer(h,"raw"));l.start({iv:d}),l.update(u),l.finish();var m=r.util.createBuffer();m.putBytes(d),m.putBytes(l.output.getBytes());var g=m.length(),v=Buffer.from(m.getBytes(g-16),"binary");return O(v)},ce=function(e,t,r,n){return X(Buffer.from("TIP:ADDRESS:ADD:"+(e+t+r+n)))},pe=function(e){return X(Buffer.from("TIP:ADDRESS:REMOVE:"+e))},de=function(e){var t="TIP:VERIFY:"+(""+e).padStart(32,"0");return Buffer.from(t)},he=function(e,t){var n=Buffer.from(e,"hex");return r.pki.ed25519.sign({message:t,privateKey:n}).toString("hex")},le=function(e){var t,r;function n(t,r,n,i,o,s){var a;return(a=e.call(this,"code: "+t+", description: "+r+", status: "+n+", extra: "+i+", requestId: "+o+" originalError: "+s)||this).code=t,a.description=r,a.status=n,a.extra=i,a.requestId=o,a.originalError=s,a}return r=e,(t=n).prototype=Object.create(r.prototype),t.prototype.constructor=t,_(t,r),n}(L(Error)),me=function(e,t){var n=O(v({alg:"EdDSA",typ:"JWT"})),i=O(v(e)),o=Buffer.from(t,"hex"),s=[n,i],a=r.pki.ed25519.sign({message:s.join("."),encoding:"utf8",privateKey:o}),u=O(a);return s.push(u),s.join(".")},ge=function(e,t,n,o,s){if(!s.session_id||!i.validate(s.session_id))return"";var a="GET";e&&(a=e.toLocaleUpperCase());var u="";"object"==typeof n?u=v(n,{unsafe:!0}):"string"==typeof n&&(u=n);var f=Math.floor(Date.now()/1e3),c=f+3600,p=r.md.sha256.create();p.update(a+t+u,"utf8");var d={uid:s.app_id,sid:s.session_id,iat:f,exp:c,jti:o,sig:p.digest().toHex(),scp:"FULL"};return me(d,s.session_private_key)},ve=function(e,t,n,i,o){if(!o.scope)return"";var s="GET";e&&(s=e.toLocaleUpperCase());var a="";"object"==typeof n?a=v(n,{unsafe:!0}):"string"==typeof n&&(a=n);var u=Math.floor(Date.now()/1e3),f=u+3600,c=r.md.sha256.create();c.update(s+t+a,"utf8");var p={iss:o.app_id,aid:o.authorization_id,iat:u,exp:f,jti:i,sig:c.digest().toHex(),scp:o.scope};return me(p,o.session_private_key)},we=function(e,t,r,n,o){return o&&o.app_id&&o.session_private_key&&i.validate(o.app_id)?32!==Buffer.from(o.session_private_key,"hex").byteLength?"":"authorization_id"in o?ve(e,t,r,n,o):ge(e,t,r,n,o):""},be=["https://api.mixin.one","https://mixin-api.zeromesh.net"];function ye(e,t){var r=(null==t?void 0:t.retry)||5,n=h.create(I({baseURL:be[0],timeout:(null==t?void 0:t.timeout)||3e3},t));return n.interceptors.request.use((function(t){var r,n=t.method,o=t.data,s=h.getUri(t).slice(null==(r=t.baseURL)?void 0:r.length);if(t.headers){var a=i.v4();t.headers["X-Request-Id"]=a;var u=we(n,s,o,a,e);t.headers.Authorization="Bearer "+u}return t})),n.interceptors.response.use(function(){var e=S(k().mark((function e(t){var r,n,i;return k().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=(r=t.data).data,!(i=r.error)){e.next=3;break}throw new le(i.code,i.description,i.status,i.extra,t.headers["x-request-id"],i);case 3:return e.abrupt("return",n);case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()),n.interceptors.response.use(void 0,function(){var e=S(k().mark((function e(r){return k().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,null==t||null==t.responseCallback?void 0:t.responseCallback(r);case 2:return e.abrupt("return",Promise.reject(r));case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()),m(n,{retries:r,shouldResetTimeout:!0,retryDelay:function(){return 500},retryCondition:function(e){return!e.response&&Boolean(e.code)&&g(e)||l.isIdempotentRequestError(e)},onRetry:function(e,r,i){var o,s;null!=t&&t.baseURL||(i.baseURL=(null==(o=r.config)?void 0:o.baseURL)===be[0]?be[1]:be[0],n.defaults.baseURL=(null==(s=r.config)?void 0:s.baseURL)===be[0]?be[1]:be[0])}}),n}h.defaults.headers.post["Content-Type"]="application/json",h.defaults.headers.put["Content-Type"]="application/json",h.defaults.headers.patch["Content-Type"]="application/json";var xe=ye(),Be=function(e,t){return ye(e,t)},ke=function(e){return{request:function(t){return e.request(t)}}},Ee=function(e){return function(t){if(void 0===t&&(t={}),!e)throw new Error("keystore client is required");var r=t.keystore,n=Be(r,t.requestConfig),i=ke(n),o=e(n,r);return Object.assign(o,i)}},Se=function(e,t){return{fetch:function(t){return e.get("/addresses/"+t)},fetchList:function(t){return e.get("/assets/"+t+"/addresses")},create:function(r,n){var i,o=ce(n.asset_id,n.destination,null!=(i=n.tag)?i:"",n.label),s=he(r,o),a=fe(s,t);return e.post("/addresses",I({},n,{pin:a}))},delete:function(r,n){var i=pe(n),o=he(r,i),s=fe(o,t);return e.post("/addresses/"+n+"/delete",{pin:s})}}},Ie=Ee(Se),Ae=function(e){return{fetch:function(t){return e.get("/apps/"+t)},fetchList:function(){return e.get("/apps")},properties:function(){return e.get("/apps/property")},favorites:function(t){return e.get("/users/"+t+"/apps/favorite")},create:function(t){return e.post("/apps",t)},update:function(t,r){return e.post("/apps/"+t,r)},updateSecret:function(t){return e.post("/apps/"+t+"/secret")},updateSafeSession:function(t,r){return e.post("/safe/apps/"+t+"/session",r)},registerSafe:function(t,r){return e.post("/safe/apps/"+t+"/register",r)},favorite:function(t){return e.post("/apps/"+t+"/favorite")},unfavorite:function(t){return e.post("/apps/"+t+"/unfavorite")}}},_e=Ee(Ae),Ce=function(e){return{fetch:function(t){return e.get("/assets/"+t)},fetchList:function(){return e.get("/assets")},snapshots:function(t){return e.get("/assets/"+t+"/snapshots")}}},Te=Ee(Ce),Le=function(e){var t,r=function(){return e.post("/attachments")},n=function(e,t){return h.create()({url:e,method:"PUT",data:t,headers:{"x-amz-acl":"public-read","Content-Type":"application/octet-stream"},maxContentLength:2147483648})};return{fetch:function(t){return e.get("/attachments/"+t)},create:r,upload:(t=S(k().mark((function e(t){var i,o,s,a;return k().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,r();case 2:if(o=(i=e.sent).view_url,a=i.attachment_id,s=i.upload_url){e.next=8;break}throw new Error("No upload URL");case 8:return e.next=10,n(s,t);case 10:return e.abrupt("return",{view_url:o,attachment_id:a});case 11:case"end":return e.stop()}}),e)}))),function(e){return t.apply(this,arguments)})}},Oe=Ee(Le),Me=function(e){try{if(!e.startsWith("XIN"))return;var t=b.decode(e.slice(3));if(68!==t.length)return;var r=t.subarray(0,t.length-4),n=Buffer.concat([Buffer.from("XIN"),Buffer.from(r)]);if(!V(n).subarray(0,4).equals(t.subarray(64)))return;return Buffer.from(r)}catch(e){return}},Pe=function(e){var t=Buffer.concat([Buffer.from("XIN"),e]),r=V(t),n=Buffer.concat([e,r.subarray(0,4)]);return"XIN"+b.encode(n)},Ne=function(e){try{if(!e.startsWith("MIX"))return;var t=b.decode(e.slice(3));if(t.length<23)return;var r=t.subarray(0,t.length-4),n=Buffer.concat([Buffer.from("MIX"),Buffer.from(r)]);if(!V(n).subarray(0,4).equals(Buffer.from(t.subarray(t.length-4))))return;var o=t.at(0),s=t.at(1),a=t.at(2);if(2!==o)return;if(!s||!a||0===s||s>a||a>64)return;var u=r.subarray(3),f=[];if(u.length===16*a){for(var c=0;c<a;c++){var p=i.stringify(u,16*c);f.push(p)}return{members:f,threshold:s}}if(u.length===64*a){for(var d=0;d<a;d++){var h=u.subarray(64*d,64*(d+1)),l=Pe(Buffer.from(h));f.push(l)}return{members:f,threshold:s}}return}catch(e){return}},Ue=function(e){if(e.members.length>255)throw new Error("invalid members length: "+e.members.length);if(0===e.threshold||e.threshold>e.members.length)throw new Error("invalid threshold: "+e.threshold);var t=Buffer.concat([Buffer.from([2]),Buffer.from([e.threshold]),Buffer.from([e.members.length])]),r="",n=[];e.members.forEach((function(e){if(e.startsWith("XIN")){if(r||(r="xin"),"xin"!==r)throw new Error("inconsistent address type");var t=Me(e);if(!t)throw new Error("invalid mainnet address: "+e);n.push(t)}else{if(r||(r="uuid"),"uuid"!==r)throw new Error("inconsistent address type");var o=i.parse(e);if(!o)throw new Error("invalid mainnet address: "+e);n.push(Buffer.from(Uint8Array.from(o)))}}));var o=Buffer.concat([Buffer.from("MIX"),t].concat(n)),s=V(o),a=Buffer.concat([t].concat(n,[s.subarray(0,4)]));return"MIX"+b.encode(a)},Re=function(e){for(var t=0,r=0;r<e.byteLength;r++){var n=e.at(r);t*=256,n&&(t+=n)}return t},De=function(){function e(e){this.buf=e}var t=e.prototype;return t.subarray=function(e,t){return this.buf.subarray(e,t)},t.read=function(e){this.buf=this.buf.subarray(e)},t.readByte=function(){var e=this.buf.readUint8();return this.read(1),e},t.readBytes=function(){var e=this.readByte(),t=this.buf.subarray(0,e).toString("hex");return this.read(e),t},t.readInt=function(){var e=this.buf.readUInt16BE();return this.read(2),e},t.readUint32=function(){var e=this.buf.readUInt32BE();return this.read(4),e},t.readUInt64=function(){var e=this.buf.readBigUInt64BE();return this.read(8),e},t.readUUID=function(){var e=this.buf.subarray(0,16);return this.read(16),e},t.readInteger=function(){var e=this.readInt(),t=this.buf.subarray(0,e);return this.read(e),Re(t)},t.decodeInput=function(){var e=this.subarray(0,32).toString("hex");this.read(32);var t={hash:e,index:this.readInt()},r=this.readInt();r>0&&(t.genesis=this.buf.subarray(0,r).toString("hex"),this.read(r));var n=this.subarray(0,2);if(this.read(2),n.equals(D)){var i=this.subarray(0,32).toString("hex");this.read(32);var o=this.readBytes(),s=this.readBytes(),a=this.readUInt64(),u=this.readInteger();t.deposit={chain:i,asset:o,transaction:s,index:a,amount:u}}var f=this.subarray(0,2);if(this.read(2),f.equals(D)){var c=this.readBytes(),p=this.readUInt64(),d=this.readInteger();t.mint={group:c,batch:p,amount:d}}return t},t.decodeOutput=function(){var e=this.subarray(0,2);if(this.read(2),0!==e.at(0))throw new Error("invalid output type "+e.at(0));for(var t=e.at(1),r=this.readInteger(),n=this.readInt(),i=[],o=0;o<n;o++){var s=this.subarray(0,32).toString("hex");this.read(32),i.push(s)}var a=this.subarray(0,32).toString("hex");this.read(32);var u=this.readInt(),f=this.buf.subarray(0,u).toString("hex");this.read(u);var c={type:t,amount:U(r,8).toString(),keys:i,mask:a,script:f},p=this.subarray(0,2);if(this.read(2),p.equals(D)){var d=this.readBytes(),h=this.readBytes();c.withdrawal={address:d,tag:h}}return c},t.decodeSignature=function(){for(var e=this.readInt(),t={},r=0;r<e;r++){var n=this.readInt(),i=this.buf.subarray(0,64).toString("hex");t[n]=i}return t},e}(),qe=function(e){return e.reduce((function(e,t){return e.plus(o(t.amount))}),o("0"))},Fe=function(e){var t=e.toString(16);if(1===t.length&&(t="0"+t),t.length>2)throw new Error("INVALID THRESHOLD "+e);return"fffe"+t},je=function(e){var t=new G(Buffer.from([]));t.write(D),t.write(Buffer.from([0,e.version])),t.write(Buffer.from(e.asset,"hex")),t.writeInt(e.inputs.length),e.inputs.forEach((function(e){t.encodeInput(e)})),t.writeInt(e.outputs.length),e.outputs.forEach((function(e){t.encodeOutput(e)}));var r=Buffer.from(e.extra);return t.writeInt(r.byteLength),t.write(r),t.writeInt(0),t.write(Buffer.from([])),t.buf.toString("hex")},He=function(e){if(2!==e.version)throw new Error("Invalid Version!");var t=I({},e,{outputs:e.outputs.filter((function(e){return!!e.mask}))});return je(t)},Ge="43d61dcd-e413-450d-80b8-101d5e903357",ze="3c8c161a18ae2c8b14fda1216fff7da88c419b5d",Ke="1700941284a95f31b25ec8c546008f208f88eee4419ccdcdbe6e3195e60128ca";function Ve(e,t,r){var n=new G(Buffer.from("NFO","utf8"));return n.write(Buffer.from([0])),t&&r?(n.write(Buffer.from([1])),n.writeUint64(BigInt(1)),n.writeUUID(Ge),n.writeSlice(Buffer.from(ze,"hex")),n.writeSlice(Buffer.from(i.parse(t))),n.writeSlice(Buffer.from(F(r)))):n.write(Buffer.from([0])),n.writeSlice(Buffer.from(e,"hex")),n.buf.toString("hex")}var Xe=function(){var e=S(k().mark((function e(t,r,n,i,o){var s,a;return k().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return void 0===o&&(o=""),e.next=3,t.transfer.outputs([{receivers:n,index:0}]);case 3:return a=He({version:2,asset:Ke,inputs:[{hash:r.transaction_hash,index:r.output_index}],outputs:[{amount:"1",mask:(s=e.sent)[0].mask,keys:s[0].keys,script:Fe(i)}],extra:Ve(o)}),e.abrupt("return",t.collection.request("sign",a));case 6:case"end":return e.stop()}}),e)})));return function(t,r,n,i,o){return e.apply(this,arguments)}}(),We=function(e,t){return Je("SEQUENCER:REGISTER:"+e+t)},Je=function(e){return X(Buffer.from(e))},Ye=function(e,t,n){var i=r.pki.ed25519.publicKeyFromPrivateKey({privateKey:n}).toString("hex"),o=V(Buffer.from(e)),s=r.pki.ed25519.sign({message:o,privateKey:n}),a=O(s),u=We(e,i);return{public_key:i,signature:a,pin_base64:(s=r.pki.ed25519.sign({message:u,privateKey:Buffer.from(t,"hex")})).toString("hex")}},Qe=function(e,t,r,n){var i=oe.hashScalar(oe.keyMultPubPriv(t,e),n),o=oe.newPoint(r),s=oe.scalarBaseMultToPoint(i),a=o.add(s);return Buffer.from(a.toRawBytes())},Ze=function(e,t){void 0===t&&(t=[]);var r=new G(Buffer.from([]));r.write(D),r.write(Buffer.from([0,e.version])),r.write(Buffer.from(e.asset,"hex")),r.writeInt(e.inputs.length),e.inputs.forEach((function(e){r.encodeInput(e)})),r.writeInt(e.outputs.length),e.outputs.forEach((function(e){r.encodeOutput(e)})),r.writeInt(e.references.length),e.references.forEach((function(e){r.write(Buffer.from(e,"hex"))}));var n=Buffer.from(e.extra);return r.writeUint32(n.byteLength),r.write(n),r.writeInt(t.length),t.forEach((function(e){r.encodeSignature(e)})),r.buf.toString("hex")},$e=function(e,t){var r=x.ungzip(e,{to:"string"}),n=JSON.parse(r);if(t.parse&&n.data&&n.data.data){n.data.data=Buffer.from(n.data.data,"base64").toString();try{n.data.data=JSON.parse(n.data.data)}catch(e){}}return n.data},et=function(e,t){return new Promise((function(r){var n=Buffer.from(JSON.stringify(t),"utf-8"),i=x.gzip(n);if(e.readyState!==w.OPEN)r(!1);else{var o=setTimeout((function(){r(!1)}),5e3);e.send(i,(function(){clearTimeout(o),r(!0)}))}}))},tt=["wss://mixin-blaze.zeromesh.net","wss://blaze.mixin.one/"],rt=function(e,t){var r,n,o=tt[0],s=function(){clearTimeout(Number(n)),r&&(r.terminate(),r=void 0)},a=function(){clearTimeout(Number(n)),n=setTimeout(s,3e4)};return{loop:function(n){if(r)throw new Error("Blaze is already running");if(!n.onMessage)throw new Error("OnMessage not set");!function n(u){r||(r=function(e,t,r,n){void 0===n&&(n={parse:!1,syncAck:!1});var o=we("GET","/","",i.v4(),e)||"",s=new w(t,"Mixin-Blaze-1",{headers:{Authorization:"Bearer "+o},handshakeTimeout:3e3});return s.onmessage=function(){var e=S(k().mark((function e(t){var o,a;return k().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(o=$e(t.data,n)){e.next=3;break}return e.abrupt("return");case 3:if("ACKNOWLEDGE_MESSAGE_RECEIPT"!==o.source||!r.onAckReceipt){e.next=8;break}return e.next=6,r.onAckReceipt(o);case 6:e.next=20;break;case 8:if("SYSTEM_CONVERSATION"!==o.category||!r.onConversation){e.next=13;break}return e.next=11,r.onConversation(o);case 11:e.next=20;break;case 13:if("SYSTEM_ACCOUNT_SNAPSHOT"!==o.category||!r.onTransfer){e.next=18;break}return e.next=16,r.onTransfer(o);case 16:e.next=20;break;case 18:return e.next=20,r.onMessage(o);case 20:if(!n.syncAck){e.next=24;break}return a={id:i.v4(),action:"ACKNOWLEDGE_MESSAGE_RECEIPT",params:{message_id:o.message_id,status:"READ"}},e.next=24,et(s,a);case 24:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),s}(e,o,u,t),a(),r.on("ping",a),r.onopen=function(){a(),r&&et(r,{id:i.v4(),action:"LIST_PENDING_MESSAGES"})},r.onclose=function(){s(),n(u)},r.onerror=function(e){"Opening handshake has timed out"===e.message&&(o=o===tt[0]?tt[1]:tt[0],s())})}(n)},stopLoop:function(){s()},getWebSocket:function(){return r}}},nt=function(e){return{fetch:function(t){return e.get("/circles/"+t)},fetchList:function(){return e.get("/circles")},conversations:function(t,r){return e.get("/circles/"+t+"/conversations",{params:r})},create:function(t){return e.post("/circles",{name:t})},update:function(t,r){return e.post("/circles/"+t,{name:r})},delete:function(t){return e.post("/circles/"+t+"/delete")},addUser:function(t,r){return e.post("/users/"+t+"/circles",{circleID:r,action:"ADD"})},removeUser:function(t,r){return e.post("/users/"+t+"/circles",{circleID:r,action:"REMOVE"})},addConversation:function(t,r){return e.post("/conversations/"+t+"/circles",{circleID:r,action:"ADD"})},removeConversation:function(t,r){return e.post("/conversations/"+t+"/circles",{circleID:r,action:"REMOVE"})}}},it=Ee(nt),ot=function(e){return{fetch:function(t){return e.get("/codes/"+t)}}},st=Ee(ot),at=function(e,t){var r=function(r,n,i){var o=fe(r,t);return e.post("/collectibles/requests/"+n+"/"+i,{pin:o})},n=function(t,r){return e.post("/collectibles/requests",{action:t,raw:r})};return{fetch:function(t){return e.get("/collectibles/tokens/"+t)},fetchCollection:function(t){return e.get("/collectibles/collections/"+t)},outputs:function(t){var r=I({},t,{members:z(t.members)});return e.get("/collectibles/outputs",{params:r})},request:n,transfer:n,sign:function(e,t){return r(e,t,"sign")},cancel:function(e,t){return r(e,t,"cancel")},unlock:function(e,t){return r(e,t,"unlock")}}},ut=Ee(at),ft=function(e,t){var r=function(t){return e.post("/conversations",t)},n=function(t,r,n){return e.post("/conversations/"+t+"/participants/"+r,n)},i=function(t,r){return e.post("/conversations/"+t+"/mute",{duration:r})};return{fetch:function(t){return e.get("/conversations/"+t)},create:r,createContact:function(e){if(!t)throw new Error("No Keystore Provided");return r({category:"CONTACT",conversation_id:K(t.app_id,e),participants:[{user_id:e}]})},createGroup:function(e,t,n){return r({category:"GROUP",conversation_id:e,name:t,participants:n})},joinGroup:function(t){return e.post("/conversations/"+t+"/join")},exitGroup:function(t){return e.post("/conversations/"+t+"/exit")},updateParticipants:n,addParticipants:function(e,t){return n(e,"ADD",t.map((function(e){return{user_id:e}})))},removeParticipants:function(e,t){return n(e,"REMOVE",t.map((function(e){return{user_id:e}})))},setAdmin:function(e,t){return n(e,"ROLE",t.map((function(e){return{user_id:e,role:"ADMIN"}})))},revokeAdmin:function(e,t){return n(e,"ROLE",t.map((function(e){return{user_id:e,role:""}})))},resetGroupCode:function(t){return e.post("/conversations/"+t+"/rotate")},updateGroupInfo:function(t,r){return e.post("/conversations/"+t,r)},mute:function(e,t){return i(e,t)},unmute:function(e){return i(e,0)},disappearDuration:function(t,r){return e.post("/conversations/"+t+"/disappear",{duration:r})}}},ct=Ee(ft),pt=function(e){return{deposits:function(t){return e.get("/external/transactions",{params:t})},checkAddress:function(t){return e.get("/external/addresses/check",{params:t})},exchangeRates:function(){return e.get("/external/fiats")},proxy:function(t){return e.post("/external/proxy",t)}}},dt=Ee(pt),ht=function(e,t){var r=function(t){return e.post("/messages",[t])},n=function(){var e=S(k().mark((function e(n,o,s){var a;return k().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t){e.next=2;break}throw new Error("No Keystore Provided");case 2:return"object"==typeof s&&(s=JSON.stringify(s)),a={category:o,recipient_id:n,conversation_id:K(t.app_id,n),message_id:i.v4(),data:O(Buffer.from(s))},e.next=6,r(a);case 6:return e.abrupt("return",a);case 7:case"end":return e.stop()}}),e)})));return function(t,r,n){return e.apply(this,arguments)}}();return{sendAcknowledgement:function(t){return e.post("/acknowledgements",[t])},sendAcknowledges:function(t){return e.post("/acknowledgements",t)},sendOne:r,sendBatch:function(t){return e.post("/messages",t)},sendMsg:n,sendText:function(e,t){return n(e,"PLAIN_TEXT",t)},sendSticker:function(e,t){return n(e,"PLAIN_STICKER",t)},sendImage:function(e,t){return n(e,"PLAIN_IMAGE",t)},sendAudio:function(e,t){return n(e,"PLAIN_AUDIO",t)},sendVideo:function(e,t){return n(e,"PLAIN_VIDEO",t)},sendContact:function(e,t){return n(e,"PLAIN_CONTACT",t)},sendAppCard:function(e,t){return n(e,"APP_CARD",t)},sendFile:function(e,t){return n(e,"PLAIN_DATA",t)},sendLive:function(e,t){return n(e,"PLAIN_LIVE",t)},sendLocation:function(e,t){return n(e,"PLAIN_LOCATION",t)},sendPost:function(e,t){return n(e,"PLAIN_POST",t)},sendAppButton:function(e,t){return n(e,"APP_BUTTON_GROUP",t)},sendTransfer:function(e,t){return n(e,"SYSTEM_ACCOUNT_SNAPSHOT",t)},sendRecall:function(e,t){return n(e,"MESSAGE_RECALL",t)}}},lt=Ee(ht),mt=function(e,t){var r=function(r,n,i){var o=fe(r,t);return e.post("/multisigs/requests/"+n+"/"+i,{pin:o})};return{outputs:function(t){var r=t.members,n=t.threshold;if(0===r.length||n<1||n>r.length)return Promise.reject(new Error("Invalid threshold or members"));var i=I({},t,{members:z(r)});return e.get("/multisigs/outputs",{params:i})},create:function(t,r){return e.post("/multisigs/requests",{action:t,raw:r})},sign:function(e,t){return r(e,t,"sign")},unlock:function(e,t){return r(e,t,"unlock")},cancel:function(e,t){return r(e,t,"cancel")},createSafeMultisigs:function(t){return e.post("/safe/multisigs",t)},fetchSafeMultisigs:function(t){return e.get("/safe/multisigs/"+t)},signSafeMultisigs:function(t,r){return e.post("/safe/multisigs/"+t+"/sign",{raw:r})},unlockSafeMultisigs:function(t){return e.post("/safe/multisigs/"+t+"/unlock")}}},gt=Ee(mt),vt=function(e){return{info:function(){return e.get("/network")},chains:function(){return e.get("/network/chains")},fetchChain:function(t){return e.get("/network/chains/"+t)},fetchAsset:function(t){return e.get("/network/assets/"+t)},topAssets:function(t){return void 0===t&&(t="ALL"),e.get("/network/assets/top",{params:{kind:t}})},searchAssets:function(t,r){return void 0===r&&(r="ALL"),e.get("/network/assets/search/"+t,{params:{kind:r}})},historicalPrice:function(t,r){return e.get("/network/ticker",{params:{asset:t,offset:r}})},snapshot:function(t){return e.get("/network/snapshots/"+t)},snapshots:function(t){var r=I({},t,{order:t.order||"DESC"});return e.get("/network/snapshots",{params:r})}}},wt=Ee(vt),bt=function(e){return{getToken:function(t){return e.post("/oauth/token",t)},authorize:function(t){return e.post("/oauth/authorize",t)},authorizations:function(t){return e.get("/authorizations",{params:{app:t}})},revokeAuthorize:function(t){return e.post("/oauth/cancel",{client_id:t})}}},yt=Ee(bt),xt=function(e){var t=function(t){return e.post("/payments",t)};return{request:t,payment:t}},Bt=Ee(xt),kt=function(e,t){return{verify:function(r){var n=fe(r,t);return e.post("/pin/verify",{pin:n})},verifyTipPin:function(r){var n=se(),i=de(n),o=he(r,i);return e.post("/pin/verify",{pin_base64:fe(o,t),timestamp:n})},update:function(r,n){void 0===n&&(n="");var i=r?fe(r,t):"",o=fe(n,t);return e.post("/pin/update",{old_pin_base64:i,pin_base64:o})},updateTipPin:function(r,n,i){var o=Buffer.from(n,"hex");if(32!==o.byteLength)throw new Error("invalid public key");var s=ue(o,i).toString("hex"),a=r?fe(r,t):"",u=fe(s,t);return e.post("/pin/update",{old_pin_base64:a,pin_base64:u})}}},Et=Ee(kt),St=function(e,t){return{register:function(r,n,i){var o=Ye(r,n,i);return o.pin_base64=fe(o.pin_base64,t),e.post("/safe/users",o)},checkRegisteration:function(){return e.get("/safe/me")},assets:function(){return e.get("/safe/assets")},fetchAsset:function(t){return e.get("/safe/assets/"+t)},fetchAssets:function(t){return e.post("/safe/assets/fetch",t)},fetchFee:function(t,r){return e.get("/safe/assets/"+t+"/fees",{params:{destination:r}})},depositEntries:function(t){return e.post("/safe/deposit/entries",t)},createDeposit:function(t){return e.post("/safe/deposit/entries",{chain_id:t})},pendingDeposits:function(t){return e.get("/safe/deposits",{params:t})},fetchSafeSnapshots:function(t){return e.get("/safe/snapshots",{params:t})},fetchSafeSnapshot:function(t){return e.get("/safe/snapshots/"+t)}}},It=Ee(St),At=function(e,t){return{fetch:function(t){return e.get("/transfers/trace/"+t)},snapshot:function(t){return e.get("/snapshots/"+t)},snapshots:function(t){return e.get("/snapshots",{params:t})},toUser:function(r,n){var i=I({},n,{pin:fe(r,t)});return e.post("/transfers",i)},toAddress:function(r,n){var i=I({},n,{pin:fe(r,t)});return e.post("/transactions",i)},outputs:function(t){return e.post("/outputs",t)}}},_t=Ee(At),Ct=function(e){return{profile:function(){return e.get("/me")},friends:function(){return e.get("/friends")},blockings:function(){return e.get("/blocking_users")},rotateCode:function(){return e.get("/me/code")},search:function(t){return e.get("/search/"+t)},fetch:function(t){return e.get("/users/"+t)},fetchList:function(t){return e.post("/users/fetch",t)},createBareUser:function(t,r){return e.post("/users",{full_name:t,session_secret:r})},update:function(t,r){return e.post("/me",{full_name:t,avatar_base64:r})},updatePreferences:function(t){return e.post("/me/preferences",t)},updateRelationships:function(t){return e.post("/relationships",t)},logs:function(t){return e.get("/logs",{params:t})}}},Tt=Ee(Ct),Lt=function(e){return{outputs:function(t){return e.get("/outputs",{params:I({},t,{members:z(t.members)})})},safeOutputs:function(t){return e.get("/safe/outputs",{params:I({},t,{members:t.members?z(t.members):void 0})})},safeAssetBalance:(t=S(k().mark((function t(r){return k().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.get("/safe/outputs",{params:I({},r,{members:r.members?z(r.members):void 0,state:"unspent"})});case 2:return t.abrupt("return",qe(t.sent).toString());case 4:case"end":return t.stop()}}),t)}))),function(e){return t.apply(this,arguments)}),fetchSafeOutputs:function(t){return e.post("/safe/outputs/fetch",t)},fetchTransaction:function(t){return e.get("/safe/transactions/"+t)},verifyTransaction:function(t){return e.post("/safe/transaction/requests",t)},sendTransactions:function(t){return e.post("/safe/transactions",t)},ghostKey:function(t){return t=t.map((function(e){return I({},e,{receivers:e.receivers.sort()})})),e.post("/safe/keys",t)}};var t},Ot=Ee(Lt);exports.AddressClient=Ie,exports.AppClient=_e,exports.AssetClient=Te,exports.AttachmentClient=Oe,exports.BlazeClient=function(e,t){return{blaze:rt(e,t)}},exports.CircleClient=it,exports.CodeClient=st,exports.CollectibleClient=ut,exports.ConversationClient=ct,exports.Decoder=De,exports.DefaultChain=Ge,exports.DefaultClass=ze,exports.DefaultNftAssetId=Ke,exports.Encoder=G,exports.ExternalClient=dt,exports.GroupMembers=["4b188942-9fb0-4b99-b4be-e741a06d1ebf","dd655520-c919-4349-822f-af92fabdbdf4","047061e6-496d-4c35-b06b-b0424a8a400d","acf65344-c778-41ee-bacb-eb546bacfb9f","a51006d0-146b-4b32-a2ce-7defbf0d7735","cf4abd9c-2cfa-4b5a-b1bd-e2b61a83fabd","50115496-7247-4e2c-857b-ec8680756bee"],exports.GroupThreshold=5,exports.MainAddressPrefix="XIN",exports.MessageClient=lt,exports.MintMinimumCost="0.001",exports.MixAddressPrefix="MIX",exports.MixAddressVersion=2,exports.MixinApi=function(e){void 0===e&&(e={});var t=e.keystore,r=Be(t,e.requestConfig),n=ke(r),i=function(e,t,r){return{address:Se(e,t),app:Ae(e),asset:Ce(e),blaze:rt(t,r.blazeOptions),attachment:Le(e),circle:nt(e),code:ot(e),collection:at(e,t),conversation:ft(e,t),external:pt(e),message:ht(e,t),multisig:mt(e,t),network:vt(e),oauth:bt(e),payment:xt(e),pin:kt(e,t),safe:St(e,t),transfer:At(e,t),user:Ct(e),utxo:Lt(e)}}(r,t,e);return B(i,n)},exports.MixinAssetID="43d61dcd-e413-450d-80b8-101d5e903357",exports.MixinCashier="674d6776-d600-4346-af46-58e77d8df185",exports.MultisigClient=gt,exports.NetworkClient=wt,exports.OAuthClient=yt,exports.OutputTypeScript=0,exports.OutputTypeWithdrawalSubmit=161,exports.PaymentClient=Bt,exports.PinClient=Et,exports.ResponseError=le,exports.SafeClient=It,exports.TIPBodyForSequencerRegister=We,exports.TransferClient=_t,exports.TxVersion=2,exports.TxVersionHashSignature=5,exports.UserClient=Tt,exports.UtxoClient=Ot,exports.WebViewApi=function(){var e,t,r,n=function(){var e={};if(window.webkit&&window.webkit.messageHandlers&&window.webkit.messageHandlers.MixinContext){var t=prompt("MixinContext.getContext()");t&&((e=JSON.parse(t)).platform=e.platform||"iOS")}else window.MixinContext&&"function"==typeof window.MixinContext.getContext&&((e=JSON.parse(window.MixinContext.getContext())).platform=e.platform||"Android");return e};return{getMixinContext:n,reloadTheme:function(){switch(n().platform){case"iOS":window.webkit&&window.webkit.messageHandlers&&window.webkit.messageHandlers.reloadTheme&&window.webkit.messageHandlers.reloadTheme.postMessage("");break;case"Android":case"Desktop":window.MixinContext&&"function"==typeof window.MixinContext.reloadTheme&&window.MixinContext.reloadTheme()}},playlist:function(e){switch(n().platform){case"iOS":window.webkit&&window.webkit.messageHandlers&&window.webkit.messageHandlers.playlist&&window.webkit.messageHandlers.playlist.postMessage(e);break;case"Android":case"Desktop":window.MixinContext&&"function"==typeof window.MixinContext.playlist&&window.MixinContext.playlist(e)}},close:function(){switch(n().platform){case"iOS":window.webkit&&window.webkit.messageHandlers&&window.webkit.messageHandlers.close&&window.webkit.messageHandlers.close.postMessage("");break;case"Android":case"Desktop":window.MixinContext&&"function"==typeof window.MixinContext.close&&window.MixinContext.close()}},getAssets:(r=S(k().mark((function e(t,r){return k().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:e.t0=n().platform,e.next="iOS"===e.t0?3:"Android"===e.t0||"Desktop"===e.t0?8:13;break;case 3:if(!(window.webkit&&window.webkit.messageHandlers&&window.webkit.messageHandlers.getAssets)){e.next=7;break}return window.assetsCallbackFunction=r,e.next=7,window.webkit.messageHandlers.getAssets.postMessage([t,"assetsCallbackFunction"]);case 7:return e.abrupt("break",14);case 8:if(!window.MixinContext||"function"!=typeof window.MixinContext.getAssets){e.next=12;break}return window.assetsCallbackFunction=r,e.next=12,window.MixinContext.getAssets(t,"assetsCallbackFunction");case 12:case 13:return e.abrupt("break",14);case 14:case"end":return e.stop()}}),e)}))),function(e,t){return r.apply(this,arguments)}),getTipAddress:(t=S(k().mark((function e(t,r){return k().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:e.t0=n().platform,e.next="iOS"===e.t0?3:"Android"===e.t0||"Desktop"===e.t0?8:13;break;case 3:if(!(window.webkit&&window.webkit.messageHandlers&&window.webkit.messageHandlers.getTipAddress)){e.next=7;break}return window.tipAddressCallbackFunction=r,e.next=7,window.webkit.messageHandlers.getTipAddress.postMessage([t,"tipAddressCallbackFunction"]);case 7:return e.abrupt("break",14);case 8:if(!window.MixinContext||"function"!=typeof window.MixinContext.getTipAddress){e.next=12;break}return window.tipAddressCallbackFunction=r,e.next=12,window.MixinContext.getTipAddress(t,"tipAddressCallbackFunction");case 12:case 13:return e.abrupt("break",14);case 14:case"end":return e.stop()}}),e)}))),function(e,r){return t.apply(this,arguments)}),tipSign:(e=S(k().mark((function e(t,r,i){return k().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:e.t0=n().platform,e.next="iOS"===e.t0?3:"Android"===e.t0||"Desktop"===e.t0?8:13;break;case 3:if(!(window.webkit&&window.webkit.messageHandlers&&window.webkit.messageHandlers.tipSign)){e.next=7;break}return window.tipSignCallbackFunction=i,e.next=7,window.webkit.messageHandlers.tipSign.postMessage([t,r,"tipSignCallbackFunction"]);case 7:return e.abrupt("break",14);case 8:if(!window.MixinContext||"function"!=typeof window.MixinContext.tipSign){e.next=12;break}return window.tipSignCallbackFunction=i,e.next=12,window.MixinContext.tipSign(t,r,"tipSignCallbackFunction");case 12:case 13:return e.abrupt("break",14);case 14:case"end":return e.stop()}}),e)}))),function(t,r,n){return e.apply(this,arguments)})}},exports.base64RawURLDecode=M,exports.base64RawURLEncode=O,exports.bigNumberToBytes=j,exports.blake3Hash=J,exports.buildClient=Ee,exports.buildCollectibleMemo=Ve,exports.buildMixAddress=Ue,exports.buildMixinOneSafePaymentUri=function(e){var t,r="";if(e.uuid&&i.validate(e.uuid))r=e.uuid;else if(e.mainnetAddress&&Me(e.mainnetAddress))r=e.mainnetAddress;else if(e.mixAddress&&Ne(e.mixAddress))r=e.mixAddress;else{if(!e.members||!e.threshold)throw new Error("fail to get payment destination address");r=Ue({members:e.members,threshold:e.threshold})}var n="https://mixin.one/pay/"+r,o={asset:e.asset,amount:e.amount,memo:e.memo,trace:null!=(t=e.trace)?t:i.v4(),return_to:e.returnTo&&encodeURIComponent(e.returnTo)};return n+"?"+y.stringify(o)},exports.buildMultiSigsTransaction=He,exports.buildNfoTransferRequest=Xe,exports.buildSafeTransaction=function(e,t,r,n,i){if(void 0===i&&(i=[]),0===e.length)throw new Error("empty inputs");if(Buffer.from(n).byteLength>512)throw new Error("extra data is too long");var o="",s=[];e.forEach((function(e){if(o||(o=e.asset),e.asset!==o)throw new Error("inconsistent asset in outputs");s.push({hash:e.transaction_hash,index:e.output_index})}));for(var a=[],u=0;u<t.length;u++){var f,c=t[u];a.push("destination"in c?{type:161,amount:c.amount,withdrawal:{address:c.destination,tag:null!=(f=c.tag)?f:""},keys:[]}:{type:0,amount:c.amount,keys:r[u].keys,mask:r[u].mask,script:Fe(c.threshold)})}return{version:5,asset:o,extra:n,inputs:s,outputs:a,references:i}},exports.buildSafeTransactionRecipient=function(e,t,r){return{members:e,threshold:t,amount:r,mixAddress:Ue({members:e,threshold:t})}},exports.buildTokenId=function(e,t){var n=Buffer.from(F(t)).toString("hex"),o=Ge.replaceAll("-","")+ze+e.replaceAll("-","")+n,s=r.md.md5.create();s.update(Buffer.from(o,"hex").toString("binary"));var a=Buffer.from(s.digest().bytes(),"binary");return a[6]=15&a[6]|48,a[8]=63&a[8]|128,i.stringify(a)},exports.bytesToInterger=Re,exports.createAxiosClient=Be,exports.createRequestClient=ke,exports.decodeMessage=$e,exports.decodeNfoMemo=function(e){var t=Buffer.from(e,"hex");if(t.byteLength<4)throw Error("Invalid NFO memo length: "+t.byteLength);var r=t.subarray(0,3).toString();if("NFO"!==r)throw Error("Invalid NFO memo prefix: "+r);var n=t.readUint8(3);if(0!==n)throw Error("Invalid NFO memo version: "+n);var o={prefix:"NFO",version:0,extra:""},s=new De(t.subarray(4));if(1===s.readByte()){if(o.mask=Number(s.readUInt64()),1!==o.mask)throw Error("Invalid NFO memo mask: "+o.mask);if(o.chain=i.stringify(s.readUUID()),o.chain!==Ge)throw Error("Invalid NFO memo chain: "+o.chain);if(o.class=s.readBytes(),o.class!==ze)throw Error("Invalid NFO memo chain: "+o.class);var a=Buffer.from(s.readBytes(),"hex");o.collection=i.stringify(a),o.token=parseInt(s.readBytes(),16)}return o.extra=Buffer.from(s.readBytes(),"hex").toString(),o},exports.decodeSafeTransaction=function(e){var t=new De(Buffer.from(e,"hex"));if(!t.subarray(0,2).equals(D))throw new Error("invalid magic");t.read(3);var r=t.readByte();if(5!==r)throw new Error("invalid version");var n=t.subarray(0,32).toString("hex");t.read(32);for(var i=t.readInt(),o=[],s=0;s<i;s++)o.push(t.decodeInput());for(var a=t.readInt(),u=[],f=0;f<a;f++)u.push(t.decodeOutput());for(var c=t.readInt(),p=[],d=0;d<c;d++){var h=t.subarray(0,32).toString("hex");t.read(32),p.push(h)}var l=t.readUint32(),m=t.subarray(0,l).toString();t.read(l);for(var g=t.readInt(),v=[],w=0;w<g;w++)v.push(t.decodeSignature());return{version:r,asset:n,extra:m,inputs:o,outputs:u,references:p,signatureMap:v}},exports.deriveGhostPublicKey=Qe,exports.edwards25519=oe,exports.encodeSafeTransaction=Ze,exports.encodeScript=Fe,exports.encodeTx=je,exports.formatUnits=U,exports.getCreateAddressTipBody=ce,exports.getED25519KeyPair=function(){var e=Buffer.from(r.random.getBytesSync(32),"binary"),t=r.pki.ed25519.generateKeyPair({seed:e});return{privateKey:Buffer.from(t.privateKey),publicKey:Buffer.from(t.publicKey),seed:e}},exports.getMainnetAddressFromPublic=Pe,exports.getMainnetAddressGhostKey=function(e,t){if(void 0===t&&(t=""),0!==e.receivers.length&&(!t||128===t.length)){var n=e.receivers.map((function(e){return Me(e)}));if(n.every((function(e){return!!e}))){var i=t?Buffer.from(t,"hex"):Buffer.from(r.random.getBytesSync(64),"binary"),o=Buffer.from(oe.scalar.toBytes(oe.setUniformBytes(i))),s=n.map((function(t){var r=t.subarray(0,32),n=t.subarray(32,64);return Qe(o,n,r,e.index).toString("hex")}));return{mask:oe.publicFromPrivate(o).toString("hex"),keys:s}}}},exports.getNanoTime=se,exports.getPublicFromMainnetAddress=Me,exports.getRemoveAddressTipBody=pe,exports.getTipPinUpdateMsg=ue,exports.getTotalBalanceFromOutputs=qe,exports.getUnspentOutputsForRecipients=function(e,t){for(var r=t.reduce((function(e,t){return e.plus(o(t.amount))}),o("0")),n=o("0"),i=0;i<e.length;i++){var s=e[i];if("unspent"===s.state&&!(n=n.plus(o(s.amount))).minus(r).isNegative())return{utxos:e.slice(0,i+1),change:n.minus(r)}}throw new Error("insufficient total input outputs")},exports.getUuid=function(){return i.v4()},exports.getVerifyPinTipBody=de,exports.hashMembers=z,exports.integerToBytes=F,exports.magic=D,exports.mixinRequest=xe,exports.newHash=V,exports.parseMixAddress=Ne,exports.parseUnits=R,exports.putUvarInt=H,exports.sendRaw=et,exports.sha256Hash=X,exports.sha512Hash=W,exports.sharedEd25519Key=ae,exports.signAccessToken=we,exports.signAuthenticationToken=ge,exports.signEd25519PIN=fe,exports.signOauthAccessToken=ve,exports.signSafeRegistration=Ye,exports.signSafeTransaction=function(e,t,r,n){void 0===n&&(n=0);for(var i=Ze(e),o=J(Buffer.from(i,"hex")),s=W(Buffer.from(r.slice(0,64),"hex")),a=oe.setBytesWithClamping(s.subarray(0,32)),u=[],f=0;f<e.inputs.length;f++){var c=Buffer.from(t[f],"hex"),p=oe.setCanonicalBytes(c),d=oe.scalar.add(p,a),h=Buffer.from(oe.scalar.toBytes(d)),l=oe.sign(o,h),m={};m[n]=l.toString("hex"),u.push(m)}return Ze(e,u)},exports.signTipBody=he,exports.sleep=function(e){return void 0===e&&(e=500),new Promise((function(t){setTimeout((function(){t()}),e)}))},exports.tipBody=Je,exports.uniqueConversationID=K;
//# sourceMappingURL=mixin-node-sdk.cjs.production.min.js.map
